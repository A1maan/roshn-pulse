{
  "version": "1.0.0",
  "description": "Locked response schema for the Scribe extractor. All backend /extract responses MUST conform to this contract.",
  "fields": [
    {
      "name": "date",
      "type": "string",
      "format": "date-iso8601",
      "nullable": true,
      "example": "2025-11-04",
      "notes": "Primary report date in YYYY-MM-DD if detected; otherwise null or original string."
    },
    {
      "name": "project",
      "type": "string",
      "nullable": true,
      "example": "NE-Cluster Phase 3"
    },
    {
      "name": "location",
      "type": "string",
      "nullable": true,
      "example": "Riyadh, KSA"
    },
    {
      "name": "subcontractors",
      "type": "array<string>",
      "nullable": false,
      "example": ["ACME MEP Co.", "SteelFix LLC"]
    },
    {
      "name": "personnel_count",
      "type": "integer",
      "nullable": true,
      "example": 42
    },
    {
      "name": "completed_tasks",
      "type": "array<string>",
      "nullable": false,
      "example": [
        "Blockwork completed at Zone B (levels 1–3).",
        "MEP rough-in finished in Tower A core."
      ]
    },
    {
      "name": "issues",
      "type": "array<object>",
      "nullable": false,
      "properties": [
        { "name": "type", "type": "string", "enum": ["delay", "issue", "safety", "quality"] },
        { "name": "summary", "type": "string" }
      ],
      "example": [
        { "type": "delay", "summary": "Drywall material shortage impacted L2 corridor." },
        { "type": "safety", "summary": "Two workers observed without gloves near rebar bending." }
      ]
    },
    {
      "name": "safety_observations",
      "type": "array<string>",
      "nullable": false,
      "example": [
        "PPE compliance improved in Zone C.",
        "Housekeeping required near Tower B hoist."
      ]
    },
    {
      "name": "low_confidence",
      "type": "boolean",
      "nullable": false,
      "example": false,
      "notes": "True if any extracted field has confidence ≤ 0.25."
    },
    {
      "name": "confidence",
      "type": "object<string,float>",
      "nullable": false,
      "constraints": { "min": 0.0, "max": 1.0 },
      "example": {
        "date": 0.92,
        "personnel_count": 0.61,
        "subcontractors": 0.55,
        "completed_tasks": 0.73,
        "issues": 0.66,
        "safety_observations": 0.58
      },
      "notes": "Per-field confidence scores in [0,1]. Missing fields may be omitted."
    },
    {
      "name": "export_csv_url",
      "type": "string",
      "nullable": true,
      "example": "/exports/scribe/1f2a6c3d4e.csv",
      "notes": "Relative URL to a CSV snapshot written by the backend (optional)."
    }
  ],
  "ordering": [
    "date",
    "project",
    "location",
    "subcontractors",
    "personnel_count",
    "completed_tasks",
    "issues",
    "safety_observations",
    "low_confidence",
    "confidence",
    "export_csv_url"
  ]
}
