var re=Object.defineProperty;var ne=(m,e,i)=>e in m?re(m,e,{enumerable:true,configurable:true,writable:true,value:i}):m[e]=i;var t=(m,e,i)=>ne(m,typeof e!="symbol"?e+"":e,i);function y(m){let e=(m>>16&255)/255,i=(m>>8&255)/255,a=(255&m)/255;return [e,i,a]}["SCREEN","LINEAR_LIGHT"].reduce((m,e,i)=>Object.assign(m,{[e]:i}),{});function T(m,e,i){return e in m?Object.defineProperty(m,e,{value:i,enumerable:true,configurable:true,writable:true}):m[e]=i,m}function b(m){let e=m.trim();if(e.length===4){let i=e.substr(1).split("").map(a=>a+a).join("");return parseInt(i,16)}if(e&&e.startsWith("#")){let i=parseInt(e.substr(1),16);return isNaN(i)?null:i}return null}var _=()=>{let m=[];for(let e=0;e<4;e++){let i=Math.floor(Math.random()*256),a=Math.floor(Math.random()*256),d=Math.floor(Math.random()*256),h=`#${i.toString(16).padStart(2,"0")}${a.toString(16).padStart(2,"0")}${d.toString(16).padStart(2,"0")}`;m.push(h);}return m};var S=class{constructor(e,i,a,d=false){t(this,"canvas");t(this,"gl");t(this,"meshes");t(this,"lastDebugMsg");t(this,"debug");t(this,"commonUniforms");t(this,"Uniform");t(this,"Attribute");t(this,"PlaneGeometry");t(this,"Material");t(this,"Mesh");t(this,"width");t(this,"height");let h=this,E=document.location.search.toLowerCase().indexOf("debug=webgl")!==-1;this.canvas=e;let A=e.getContext("webgl",{antialias:true});if(!A)throw new Error("WebGL not supported");this.gl=A,this.meshes=[];let n=this.gl;i&&a&&this.setSize(i,a),this.lastDebugMsg=void 0,this.debug=d&&E?function(...s){let l=s[0]||"",r=new Date;(!h.lastDebugMsg||r.getTime()-h.lastDebugMsg.getTime()>1e3)&&console.log("---");let o=r.toLocaleTimeString(),c=Array(Math.max(0,32-l.length)).join(" ");console.log(o+c+l+": ",...s.slice(1)),h.lastDebugMsg=r;}:()=>{},Object.defineProperties(h,{Material:{enumerable:false,value:class{constructor(s,l,r={}){t(this,"vertexSource");t(this,"Source");t(this,"vertexShader");t(this,"fragmentShader");t(this,"program");t(this,"uniforms");t(this,"uniformInstances");function o(g,v){let p=n.createShader(g);if(!p)throw new Error("Cannot create shader");return n.shaderSource(p,v),n.compileShader(p),n.getShaderParameter(p,n.COMPILE_STATUS)||console.error(n.getShaderInfoLog(p)),h.debug("Material.compileShaderSource",v),p}function c(g,v){return Object.entries(g).map(([p,C])=>C.getDeclaration(p,v)).join(`
`)}this.uniforms=r,this.uniformInstances=[];let u=`
              precision highp float;
            `;this.vertexSource=`${u}
              attribute vec4 position;
              attribute vec2 uv;
              attribute vec2 uvNorm;
              ${c(h.commonUniforms,"vertex")}
              ${c(r,"vertex")}
              ${s}
            `,this.Source=`${u}
              ${c(h.commonUniforms,"fragment")}
              ${c(r,"fragment")}
              ${l}
            `,this.vertexShader=o(n.VERTEX_SHADER,this.vertexSource),this.fragmentShader=o(n.FRAGMENT_SHADER,this.Source);let f=n.createProgram();if(!f)throw new Error("Cannot create program");this.program=f,n.attachShader(this.program,this.vertexShader),n.attachShader(this.program,this.fragmentShader),n.linkProgram(this.program),n.getProgramParameter(this.program,n.LINK_STATUS)||console.error(n.getProgramInfoLog(this.program)),n.useProgram(this.program),this.attachUniforms(void 0,h.commonUniforms),this.attachUniforms(void 0,this.uniforms);}attachUniforms(s,l){let r=this;if(typeof s>"u"&&l&&typeof l=="object"&&!("type"in l)){Object.entries(l).forEach(([c,u])=>{r.attachUniforms(c,u);});return}let o=l;if(o.type==="array"){o.value.forEach((c,u)=>{r.attachUniforms(`${s}[${u}]`,c);});return}if(o.type==="struct"){Object.entries(o.value).forEach(([c,u])=>{r.attachUniforms(`${s}.${c}`,u);});return}h.debug("Material.attachUniforms",s||"",o.type),r.uniformInstances.push({uniform:o,location:n.getUniformLocation(r.program,s)});}}},Uniform:{enumerable:false,value:class{constructor(s){t(this,"type");t(this,"value");t(this,"transpose");t(this,"excludeFrom");t(this,"typeFn");this.type="float",Object.assign(this,s),this.typeFn={float:"1f",int:"1i",vec2:"2fv",vec3:"3fv",vec4:"4fv",mat4:"Matrix4fv"}[this.type]||"1f";}update(s){if(typeof this.value>"u")return;if(this.typeFn.startsWith("Matrix")){let r=n["uniform"+this.typeFn];typeof r=="function"&&r.call(n,s,this.transpose??false,this.value);return}let l=n["uniform"+this.typeFn];typeof l=="function"&&(this.typeFn.endsWith("v")?l.call(n,s,this.value):l.call(n,s,this.value));}getDeclaration(s,l,r=0){let o=this;if(o.excludeFrom===l)return "";if(o.type==="array")return o.value[0].getDeclaration(s,l,o.value.length)+`
const int ${s}_length = ${o.value.length};`;if(o.type==="struct"){let u=s.replace(/^u_/,"");u=u.charAt(0).toUpperCase()+u.slice(1);let f=Object.entries(o.value).map(([v,p])=>p.getDeclaration(v,l).replace(/^uniform\s*/,"")).join(`
`),g=r>0?`[${r}]`:"";return `struct ${u} {
${f}
};
uniform ${u} ${s}${g};`}let c=r>0?`[${r}]`:"";return `uniform ${o.type} ${s}${c};`}}},PlaneGeometry:{enumerable:false,value:class{constructor(s=1,l=1,r=1,o=1,c="xz"){t(this,"attributes");t(this,"xSegCount");t(this,"ySegCount");t(this,"vertexCount");t(this,"quadCount");t(this,"width");t(this,"height");t(this,"orientation");n.createBuffer(),this.attributes={position:new h.Attribute({target:n.ARRAY_BUFFER,size:3}),uv:new h.Attribute({target:n.ARRAY_BUFFER,size:2}),uvNorm:new h.Attribute({target:n.ARRAY_BUFFER,size:2}),index:new h.Attribute({target:n.ELEMENT_ARRAY_BUFFER,size:3,type:n.UNSIGNED_SHORT})},this.setTopology(r,o),this.setSize(s,l,c);}setTopology(s=1,l=1){let r=this;r.xSegCount=s,r.ySegCount=l,r.vertexCount=(r.xSegCount+1)*(r.ySegCount+1),r.quadCount=r.xSegCount*r.ySegCount*2,r.attributes.uv.values=new Float32Array(2*r.vertexCount),r.attributes.uvNorm.values=new Float32Array(2*r.vertexCount),r.attributes.index.values=new Uint16Array(3*r.quadCount);for(let o=0;o<=r.ySegCount;o++)for(let c=0;c<=r.xSegCount;c++){let u=o*(r.xSegCount+1)+c;if(r.attributes.uv.values[2*u]=c/r.xSegCount,r.attributes.uv.values[2*u+1]=1-o/r.ySegCount,r.attributes.uvNorm.values[2*u]=c/r.xSegCount*2-1,r.attributes.uvNorm.values[2*u+1]=1-o/r.ySegCount*2,c<r.xSegCount&&o<r.ySegCount){let f=o*r.xSegCount+c;r.attributes.index.values[6*f]=u,r.attributes.index.values[6*f+1]=u+1+r.xSegCount,r.attributes.index.values[6*f+2]=u+1,r.attributes.index.values[6*f+3]=u+1,r.attributes.index.values[6*f+4]=u+1+r.xSegCount,r.attributes.index.values[6*f+5]=u+2+r.xSegCount;}}r.attributes.uv.update(),r.attributes.uvNorm.update(),r.attributes.index.update(),h.debug("Geometry.setTopology");}setSize(s=1,l=1,r="xz"){let o=this;o.width=s,o.height=l,o.orientation=r,o.attributes.position.values&&o.attributes.position.values.length===3*o.vertexCount||(o.attributes.position.values=new Float32Array(3*o.vertexCount));let c=s/-2,u=l/-2,f=s/o.xSegCount,g=l/o.ySegCount;for(let v=0;v<=o.ySegCount;v++){let p=u+v*g;for(let C=0;C<=o.xSegCount;C++){let ie=c+C*f,q=v*(o.xSegCount+1)+C;o.attributes.position.values[3*q+"xyz".indexOf(r[0])]=ie,o.attributes.position.values[3*q+"xyz".indexOf(r[1])]=-p;}}o.attributes.position.update(),h.debug("Geometry.setSize");}}},Mesh:{enumerable:false,value:class{constructor(s,l){t(this,"geometry");t(this,"material");t(this,"wireframe",false);t(this,"attributeInstances",[]);let r=this;r.geometry=s,r.material=l,r.wireframe=false,r.attributeInstances=[],Object.entries(r.geometry.attributes).forEach(([o,c])=>{let u=c;r.attributeInstances.push({attribute:u,location:u.attach(o,r.material.program)});}),h.meshes.push(r),h.debug("Mesh.constructor");}draw(){n.useProgram(this.material.program),this.material.uniformInstances.forEach(s=>s.uniform.update(s.location)),this.attributeInstances.forEach(({attribute:s,location:l})=>s.use(l)),n.drawElements(this.wireframe?n.LINES:n.TRIANGLES,this.geometry.attributes.index.values?.length||0,n.UNSIGNED_SHORT,0);}remove(){h.meshes=h.meshes.filter(s=>s!==this);}}},Attribute:{enumerable:false,value:class{constructor(s){t(this,"type");t(this,"normalized");t(this,"buffer");t(this,"target");t(this,"size");t(this,"values");this.type=n.FLOAT,this.normalized=false,this.buffer=n.createBuffer(),this.target=s.target||n.ARRAY_BUFFER,this.size=s.size||1,s.type!==void 0&&(this.type=s.type),this.update();}update(){typeof this.values<"u"&&(n.bindBuffer(this.target,this.buffer),n.bufferData(this.target,this.values,n.STATIC_DRAW));}attach(s,l){let r=n.getAttribLocation(l,s);return this.target===n.ARRAY_BUFFER&&(n.enableVertexAttribArray(r),n.vertexAttribPointer(r,this.size,this.type,this.normalized,0,0)),r}use(s){n.bindBuffer(this.target,this.buffer),this.target===n.ARRAY_BUFFER&&(n.enableVertexAttribArray(s),n.vertexAttribPointer(s,this.size,this.type,this.normalized,0,0));}}}});let W=[1,0,0,0,0,1,0,0,0,0,1,0,0,0,0,1];this.commonUniforms={projectionMatrix:new this.Uniform({type:"mat4",value:W}),modelViewMatrix:new this.Uniform({type:"mat4",value:W}),resolution:new this.Uniform({type:"vec2",value:[1,1]}),aspectRatio:new this.Uniform({type:"float",value:1})};}setSize(e=640,i=480){this.width=e,this.height=i,this.canvas.width=e,this.canvas.height=i,this.gl.viewport(0,0,e,i),this.commonUniforms.resolution.value=[e,i],this.commonUniforms.aspectRatio.value=e/i,this.debug("MiniGL.setSize");}setOrthographicCamera(e=0,i=0,a=0,d=-2e3,h=2e3){let E=this.width,A=this.height;this.commonUniforms.projectionMatrix.value=[2/E,0,0,0,0,2/A,0,0,0,0,2/(d-h),0,e,i,a,1],this.debug("setOrthographicCamera");}render(){this.gl.clearColor(0,0,0,0),this.gl.clearDepth(1),this.meshes.forEach(e=>e.draw());}};t(S,"Uniform"),t(S,"Attribute"),t(S,"PlaneGeometry"),t(S,"Material"),t(S,"Mesh");var B={vertex:"varying vec3 v_color;void main(){float time=u_time*u_global.noiseSpeed;vec2 noiseCoord=resolution*uvNorm*u_global.noiseFreq;vec2 st=1.-uvNorm.xy;float tilt=resolution.y/2.0*uvNorm.y;float incline=resolution.x*uvNorm.x/2.0*u_vertDeform.incline;float offset=resolution.x/2.0*u_vertDeform.incline*mix(u_vertDeform.offsetBottom,u_vertDeform.offsetTop,uv.y);float noise=snoise(vec3(noiseCoord.x*u_vertDeform.noiseFreq.x+time*u_vertDeform.noiseFlow,noiseCoord.y*u_vertDeform.noiseFreq.y,time*u_vertDeform.noiseSpeed+u_vertDeform.noiseSeed))*u_vertDeform.noiseAmp;noise*=1.0-pow(abs(uvNorm.y),2.0);noise=max(0.0,noise);vec3 pos=vec3(position.x,position.y+tilt+incline+noise-offset,position.z);if(u_active_colors[0]==1.){v_color=u_baseColor;}for(int i=0;i<u_waveLayers_length;i++){if(u_active_colors[i+1]==1.){WaveLayers layer=u_waveLayers[i];float noise=smoothstep(layer.noiseFloor,layer.noiseCeil,snoise(vec3(noiseCoord.x*layer.noiseFreq.x+time*layer.noiseFlow,noiseCoord.y*layer.noiseFreq.y,time*layer.noiseSpeed+layer.noiseSeed))/2.0+0.5);v_color=blendNormal(v_color,layer.color,pow(noise,4.));}}gl_Position=projectionMatrix*modelViewMatrix*vec4(pos,1.0);}",noise:"vec3 mod289(vec3 x){return x-floor(x*(1.0/289.0))*289.0;}vec4 mod289(vec4 x){return x-floor(x*(1.0/289.0))*289.0;}vec4 permute(vec4 x){return mod289(((x*34.0)+1.0)*x);}vec4 taylorInvSqrt(vec4 r){return 1.79284291400159-0.85373472095314*r;}float snoise(vec3 v){const vec2 C=vec2(1.0/6.0,1.0/3.0);const vec4 D=vec4(0.0,0.5,1.0,2.0);vec3 i=floor(v+dot(v,C.yyy));vec3 x0=v-i+dot(i,C.xxx);vec3 g=step(x0.yzx,x0.xyz);vec3 l=1.0-g;vec3 i1=min(g.xyz,l.zxy);vec3 i2=max(g.xyz,l.zxy);vec3 x1=x0-i1+C.xxx;vec3 x2=x0-i2+C.yyy;vec3 x3=x0-D.yyy;i=mod289(i);vec4 p=permute(permute(permute(i.z+vec4(0.0,i1.z,i2.z,1.0))+i.y+vec4(0.0,i1.y,i2.y,1.0))+i.x+vec4(0.0,i1.x,i2.x,1.0));float n_=0.142857142857;vec3 ns=n_*D.wyz-D.xzx;vec4 j=p-49.0*floor(p*ns.z*ns.z);vec4 x_=floor(j*ns.z);vec4 y_=floor(j-7.0*x_);vec4 x=x_*ns.x+ns.yyyy;vec4 y=y_*ns.x+ns.yyyy;vec4 h=1.0-abs(x)-abs(y);vec4 b0=vec4(x.xy,y.xy);vec4 b1=vec4(x.zw,y.zw);vec4 s0=floor(b0)*2.0+1.0;vec4 s1=floor(b1)*2.0+1.0;vec4 sh=-step(h,vec4(0.0));vec4 a0=b0.xzyw+s0.xzyw*sh.xxyy;vec4 a1=b1.xzyw+s1.xzyw*sh.zzww;vec3 p0=vec3(a0.xy,h.x);vec3 p1=vec3(a0.zw,h.y);vec3 p2=vec3(a1.xy,h.z);vec3 p3=vec3(a1.zw,h.w);vec4 norm=taylorInvSqrt(vec4(dot(p0,p0),dot(p1,p1),dot(p2,p2),dot(p3,p3)));p0*=norm.x;p1*=norm.y;p2*=norm.z;p3*=norm.w;vec4 m=max(0.6-vec4(dot(x0,x0),dot(x1,x1),dot(x2,x2),dot(x3,x3)),0.0);m=m*m;return 42.0*dot(m*m,vec4(dot(p0,x0),dot(p1,x1),dot(p2,x2),dot(p3,x3)));}",blend:"vec3 blendNormal(vec3 base,vec3 blend){return blend;}vec3 blendNormal(vec3 base,vec3 blend,float opacity){return(blendNormal(base,blend)*opacity+base*(1.0-opacity));}",fragment:"varying vec3 v_color;void main(){vec3 color=v_color;if(u_darken_top==1.0){vec2 st=gl_FragCoord.xy/resolution.xy;color.g-=pow(st.y+sin(-12.0)*st.x,u_shadow_power)*0.4;}gl_FragColor=vec4(color,1.0);}"};var F=1253106,H=1e3/15;var x=1;var Y=3e3,M=300,O=[.06,.16],k=1,$=0,j="",Q=false,G={root:null,rootMargin:"0px",threshold:.05},X={1:true,2:true,3:true,4:true},L="smooth",U=300,K=300,w=320,I=5,N=14e-5,D=29e-5,R=1e-5;var Z=5,J=6,ee=600;var te=[16711680,16711680,16711935,65280,255],P=["--mesh-gradient-color-1","--mesh-gradient-color-2","--mesh-gradient-color-3","--mesh-gradient-color-4"],z=[1,1,1,1];var V=class{constructor(){t(this,"init");t(this,"isInitialized",false);t(this,"el");t(this,"amp",w);t(this,"seed",I);t(this,"freqX",N);t(this,"freqY",D);t(this,"freqDelta",R);t(this,"activeColors",z);t(this,"isStatic",false);t(this,"animationSpeed",x);t(this,"autoPauseOnInvisible",true);t(this,"minigl");t(this,"angle",0);t(this,"isLoadedClass",false);t(this,"resizeTimeout");t(this,"resizeDelay",M);t(this,"isIntersecting",false);t(this,"wasPlayingBeforeInvisible",false);t(this,"intersectionObserver");t(this,"pauseObserverOptions",G);t(this,"width");t(this,"height");t(this,"shaderFiles");t(this,"vertexShader");t(this,"sectionColors");t(this,"configColors");t(this,"appearanceMode",L);t(this,"appearanceDuration",U);t(this,"computedCanvasStyle");t(this,"conf");t(this,"uniforms");t(this,"mesh");t(this,"material");t(this,"geometry");t(this,"t",F);t(this,"last",0);t(this,"frame",0);t(this,"xSegCount");t(this,"ySegCount");t(this,"resize");t(this,"animate");t(this,"addIsLoadedClass");this.initializeProperties(),this.setupEventHandlers();}destroy(){this.stopAnimationAndTimers(),this.disconnect(),this.removeCssClasses(),this.cleanupWebGLResources(),this.clearObjectReferences(),this.isInitialized=false;}update(e){if(!this.el)return;e?.transition??true?this.updateWithFadeTransition(e||{}):(this.destroy(),this.init(this.el,{...e,appearance:"default"}));}updateWithFadeTransition(e){if(!this.el)return;let i=e.transitionDuration||K,a=this.el,d=a;a.style.transition=`opacity ${i}ms ease-in-out`,a.style.opacity="1",requestAnimationFrame(()=>{a.style.opacity="0";}),setTimeout(()=>{this.destroy(),this.init(d,e),this.el&&(this.el.style.opacity="0",this.el.style.transition=`opacity ${i}ms ease-in-out`,requestAnimationFrame(()=>{this.el&&(this.el.style.opacity="");}),setTimeout(()=>{this.el&&(this.el.style.transition="",this.el.style.opacity="");},i));},i);}play(){this.conf&&(this.conf.playing=true,requestAnimationFrame(this.animate));}pause(){this.conf&&(this.conf.playing=false);}setAnimationSpeed(e){if(e<=0)throw new Error("Animation speed must be greater than 0");this.animationSpeed=e;}getAnimationSpeed(){return this.animationSpeed}toggleAutoPause(e){this.autoPauseOnInvisible=e,!e&&this.intersectionObserver?(this.intersectionObserver.disconnect(),this.intersectionObserver=void 0,!this.isIntersecting&&this.wasPlayingBeforeInvisible&&(this.play(),this.wasPlayingBeforeInvisible=false)):e&&this.el&&!this.intersectionObserver&&this.initIntersectionObserver();}stopAnimationAndTimers(){this.pause(),this.resizeTimeout&&(clearTimeout(this.resizeTimeout),this.resizeTimeout=void 0);}removeCssClasses(){this.el&&(this.el.classList.remove("isLoaded"),this.el.parentElement&&this.el.parentElement.classList.remove("isLoaded"));}cleanupWebGLResources(){this.mesh&&(this.mesh.remove(),this.mesh=void 0),this.minigl&&(this.cleanupMiniGlMeshes(),this.cleanupWebGLContext(),this.clearCanvasAsFallback());}cleanupMiniGlMeshes(){this.minigl&&(this.minigl.meshes.forEach(e=>{e.remove&&e.remove();}),this.minigl.meshes=[]);}cleanupWebGLContext(){if(!this.minigl?.gl)return;let e=this.minigl.gl;e.clearColor(0,0,0,0),e.clear(e.COLOR_BUFFER_BIT|e.DEPTH_BUFFER_BIT),this.deleteShaders(e),this.deleteBuffers(e);}deleteShaders(e){this.material&&(this.material.vertexShader&&e.deleteShader(this.material.vertexShader),this.material.fragmentShader&&e.deleteShader(this.material.fragmentShader),this.material.program&&e.deleteProgram(this.material.program));}deleteBuffers(e){this.geometry?.attributes&&Object.values(this.geometry.attributes).forEach(i=>{i.buffer&&e.deleteBuffer(i.buffer);});}clearCanvasAsFallback(){if(!this.minigl?.canvas)return;let e=this.minigl.canvas,i=e.getContext("2d");i&&i.clearRect(0,0,e.width,e.height);}clearObjectReferences(){this.el=null,this.minigl=void 0,this.mesh=void 0,this.material=void 0,this.geometry=void 0,this.uniforms=void 0,this.shaderFiles=void 0,this.vertexShader=void 0,this.sectionColors=void 0,this.configColors=void 0,this.computedCanvasStyle=void 0,this.conf=void 0;}initializeProperties(){let e={el:void 0,minigl:void 0,angle:0,isLoadedClass:false,isInitialized:false,resizeTimeout:void 0,resizeDelay:M,isIntersecting:false,shaderFiles:void 0,vertexShader:void 0,sectionColors:void 0,configColors:void 0,appearanceMode:L,appearanceDuration:U,computedCanvasStyle:void 0,conf:void 0,uniforms:void 0,mesh:void 0,material:void 0,geometry:void 0,t:F,last:0,frame:0,width:void 0,height:void 0,xSegCount:void 0,ySegCount:void 0,amp:w,seed:I,freqX:N,freqY:D,freqDelta:R,activeColors:[...z],animationSpeed:x,autoPauseOnInvisible:true};Object.assign(this,e);}setupEventHandlers(){T(this,"resize",()=>{this.resizeTimeout&&clearTimeout(this.resizeTimeout),this.resizeTimeout=window.setTimeout(()=>{this.performResize();},this.resizeDelay);}),T(this,"animate",e=>{if(this.shouldSkipFrame(e)||(this.t+=Math.min(e-this.last,H)*this.animationSpeed,this.last=e,this.mesh&&this.mesh.material&&this.mesh.material.uniforms&&this.mesh.material.uniforms.u_time&&(this.mesh.material.uniforms.u_time.value=this.t),this.minigl&&this.minigl.render()),this.last!==0&&this.isStatic){this.minigl&&this.minigl.render(),this.disconnect();return}this.frame+=1,this.conf&&this.conf.playing&&requestAnimationFrame(this.animate);}),T(this,"addIsLoadedClass",()=>{this.isLoadedClass||(this.isLoadedClass=true,this.el&&(this.appearanceMode==="smooth"&&(this.el.style.opacity="0",this.el.style.transition=`opacity ${this.appearanceDuration}ms ease-in-out`,requestAnimationFrame(()=>{this.el&&(this.el.style.opacity="1");}),setTimeout(()=>{this.el&&(this.el.style.transition="",this.el.style.opacity="");},this.appearanceDuration)),this.el.classList.add("isLoaded")),setTimeout(()=>{this.el&&this.el.parentElement&&this.el.parentElement.classList.add("isLoaded");},Y));}),T(this,"init",(e,i)=>{this.seed=i?.seed||Math.random()*100,this.isStatic=i?.isStatic||false,this.animationSpeed=i?.animationSpeed||x,this.resizeDelay=i?.resizeDelay||M,typeof i?.frequency=="number"?(this.freqX=i.frequency,this.freqY=i.frequency,this.freqDelta=i.frequency):(this.freqX=i?.frequency?.x||N,this.freqY=i?.frequency?.y||D,this.freqDelta=i?.frequency?.delta||R);let a={...X,...i?.activeColors};return this.activeColors=[a[1]?1:0,a[2]?1:0,a[3]?1:0,a[4]?1:0],this.configColors=i?.colors??(i?.cssVariablesFallback?void 0:_()),this.appearanceMode=i?.appearance||L,this.appearanceDuration=i?.appearanceDuration||U,this.pauseObserverOptions={...G,...i?.pauseObserverOptions},this.autoPauseOnInvisible=i?.pauseOnOutsideViewport??true,this.conf={presetName:j,wireframe:Q,zoom:k,rotation:$,density:O,playing:true},this.el=typeof e=="string"?document.querySelector(e):e,this.connect(),this});}performResize(){if(this.el){let e=this.el.getBoundingClientRect();this.width=e.width,this.height=e.height;}this.minigl&&this.width&&this.height&&(this.minigl.setSize(this.width,this.height),this.minigl.setOrthographicCamera()),this.xSegCount=Math.ceil(this.width*(this.conf?this.conf.density[0]:O[0])),this.ySegCount=Math.ceil((this.height||0)*(this.conf?this.conf.density[1]:O[1])),this.mesh&&this.mesh.geometry&&(this.mesh.geometry.setTopology(this.xSegCount,this.ySegCount),this.mesh.geometry.setSize(this.width,this.height||0)),this.mesh&&this.mesh.material&&this.mesh.material.uniforms&&this.mesh.material.uniforms.u_shadow_power&&(this.mesh.material.uniforms.u_shadow_power.value=this.width<ee?Z:J);}async connect(){if(this.shaderFiles=B,document.querySelectorAll("canvas").length<1)console.log("DID NOT LOAD CANVAS");else if(this.el||(this.el=document.querySelector("canvas")),this.el){let e=this.el.getBoundingClientRect();this.width=e.width,this.height=e.height,this.appearanceMode==="smooth"&&(this.el.style.opacity="0"),this.minigl=new S(this.el,null,null,true),this.initIntersectionObserver(),this.isInitialized=true,requestAnimationFrame(()=>{this.el&&(this.computedCanvasStyle=getComputedStyle(this.el),this.waitForCssVars());});}}disconnect(){this.intersectionObserver&&(this.intersectionObserver.disconnect(),this.intersectionObserver=void 0),window.removeEventListener("resize",this.resize);}initIntersectionObserver(){if(!this.el||!this.autoPauseOnInvisible)return;let e=this.pauseObserverOptions;this.intersectionObserver=new IntersectionObserver(i=>{i.forEach(a=>{let d=a.isIntersecting;this.isIntersecting!==d&&(this.isIntersecting=d,this.autoPauseOnInvisible&&this.conf&&(d?this.wasPlayingBeforeInvisible&&(this.play(),this.wasPlayingBeforeInvisible=false):this.conf.playing&&(this.wasPlayingBeforeInvisible=true,this.pause())));});},e),this.intersectionObserver.observe(this.el);}initMaterial(){if(!this.minigl)throw new Error("MiniGl not initialized");let e=this.minigl;return this.uniforms={...this.createBasicUniforms(e),...this.createGlobalUniform(e),...this.createVertexDeformUniform(e),...this.createColorUniforms(e)},this.createWaveLayersUniforms(e),this.buildVertexShader(),new this.minigl.Material(this.vertexShader,this.shaderFiles.fragment,this.uniforms)}createBasicUniforms(e){return {u_time:new e.Uniform({value:0}),u_shadow_power:new e.Uniform({value:5}),u_darken_top:new e.Uniform({value:this.el&&this.el.dataset&&this.el.dataset.jsDarkenTop===""?1:0}),u_active_colors:new e.Uniform({value:this.activeColors,type:"vec4"})}}createGlobalUniform(e){return {u_global:new e.Uniform({value:{noiseFreq:new e.Uniform({value:[this.freqX,this.freqY],type:"vec2"}),noiseSpeed:new e.Uniform({value:5e-6})},type:"struct"})}}createVertexDeformUniform(e){return {u_vertDeform:new e.Uniform({value:{incline:new e.Uniform({value:Math.sin(this.angle)/Math.cos(this.angle)}),offsetTop:new e.Uniform({value:-0.5}),offsetBottom:new e.Uniform({value:-0.5}),noiseFreq:new e.Uniform({value:[3,4],type:"vec2"}),noiseAmp:new e.Uniform({value:this.amp}),noiseSpeed:new e.Uniform({value:10}),noiseFlow:new e.Uniform({value:3}),noiseSeed:new e.Uniform({value:this.seed})},type:"struct",excludeFrom:"fragment"})}}createColorUniforms(e){return {u_baseColor:new e.Uniform({value:this.sectionColors&&this.sectionColors[0]||[1,0,0],type:"vec3",excludeFrom:"fragment"}),u_waveLayers:new e.Uniform({value:[],excludeFrom:"fragment",type:"array"})}}createWaveLayersUniforms(e){if(!(!this.uniforms||!this.sectionColors))for(let i=1;i<this.sectionColors.length;i+=1)this.uniforms.u_waveLayers.value.push(new e.Uniform({type:"struct",value:{color:new e.Uniform({value:this.sectionColors[i],type:"vec3"}),noiseFreq:new e.Uniform({value:[2+i/this.sectionColors.length,3+i/this.sectionColors.length],type:"vec2"}),noiseSpeed:new e.Uniform({value:11+.3*i}),noiseFlow:new e.Uniform({value:6.5+.3*i}),noiseSeed:new e.Uniform({value:this.seed+10*i}),noiseFloor:new e.Uniform({value:.1}),noiseCeil:new e.Uniform({value:.63+.07*i})}}));}buildVertexShader(){this.vertexShader=[this.shaderFiles.noise,this.shaderFiles.blend,this.shaderFiles.vertex].join(`

`);}initMesh(){this.material=this.initMaterial(),this.geometry=new this.minigl.PlaneGeometry,this.mesh=new this.minigl.Mesh(this.geometry,this.material);}shouldSkipFrame(e){return !!window.document.hidden||!(this.conf&&this.conf.playing)||this.frame%2===0||void 0}initSystem(){this.initGradientColors(),this.initMesh(),this.performResize(),requestAnimationFrame(this.animate),window.addEventListener("resize",this.resize);}async waitForCssVars(){if(this.configColors){this.initSystem(),this.addIsLoadedClass();return}if(this.areCssVarsLoaded()){this.initSystem(),this.addIsLoadedClass();return}try{await this.pollForCssVars(),this.initSystem(),this.addIsLoadedClass();}catch{this.useFallbackColors(),this.initSystem();}}areCssVarsLoaded(){return !!(this.computedCanvasStyle&&this.computedCanvasStyle.getPropertyValue(P[0]).indexOf("#")!==-1)}pollForCssVars(){return new Promise((e,i)=>{let h=Date.now(),E=()=>{if(this.areCssVarsLoaded()){e();return}if(Date.now()-h>3e3){i(new Error("CSS variables timeout"));return}let A=Date.now()-h,n=Math.min(50+A/20,200);setTimeout(E,n);};E();})}useFallbackColors(){this.sectionColors=te.map(e=>y(e));}initGradientColors(){if(this.configColors){this.sectionColors=this.configColors.map(i=>b(i)).filter(i=>i!==null).map(i=>y(i));return}let e=P;if(this.sectionColors=e.map(i=>{let a=this.computedCanvasStyle?this.computedCanvasStyle.getPropertyValue(i):"";return b(a)}).filter(i=>i!==null).map(i=>y(i)),!this.sectionColors||this.sectionColors.length===0){let i=_();this.sectionColors=i.map(a=>b(a)).filter(a=>a!==null).map(a=>y(a));}}};export{V as MeshGradient,_ as genRandomColors,y as normalizeColor};//# sourceMappingURL=index.mjs.map
//# sourceMappingURL=index.mjs.map